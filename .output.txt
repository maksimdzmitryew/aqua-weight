
> test:unit:coverage
> vitest --config ./vitest.config.ts run --coverage
 RUN  v3.2.4 /app/frontend
      Coverage enabled with v8
stderr | tests/unit/components/BulkMeasurementTable.test.jsx > BulkMeasurementTable > does not render badge when retained > threshold; renders plain text when no uuid
Warning: Each child in a list should have a unique "key" prop.
Check the render method of `BulkMeasurementTable`. See https://reactjs.org/link/warning-keys for more information.
    at tr
    at BulkMeasurementTable (/app/frontend/src/components/BulkMeasurementTable.jsx:7:33)
 ✓ tests/unit/components/BulkMeasurementTable.test.jsx (15 tests) 3526ms
   ✓ BulkMeasurementTable > renders rows and needs-water badge when retained ≤ threshold; link click calls onViewPlant  1057ms
   ✓ BulkMeasurementTable > inputStatus toggles success/error classes; onCommitValue fires on blur only with value and uuid  329ms
   ✓ BulkMeasurementTable > first column tooltip and label render, and cell titles depend on uuid  371ms
 ❯ tests/unit/pages/LocationCreate.test.jsx (5 tests | 1 failed) 4552ms
   × pages/LocationCreate > client-side validation: empty name shows error and a11y wiring; clears on change 1929ms
     → Unable to find an element with the text: /name is required/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.
Ignored nodes: comments, script, style
<body>
  <div>
    <div
      class="layout"
    >
      <aside
        class="sidebar"
      >
        <div
          class="sidebar-title"
        >
          Create New Location
        </div>
        <nav>
          <a
            class="nav-link"
            href="/dashboard"
          >
            Overview
          </a>
          <a
            class="nav-link"
            href="/daily"
          >
            Daily Care
          </a>
          <a
            class="nav-link"
            href="/plants"
          >
            Plants
          </a>
          <a
            class="nav-link"
            href="/locations"
          >
            Locations
          </a>
          <a
            class="nav-link"
            href="/settings"
          >
            Settings
          </a>
        </nav>
        <div
          class="mt-4"
        >
          <a
            class="back-link"
            href="/"
          >
            ← Back to Home
          </a>
        </div>
      </aside>
      <main
        class="main"
      >
        <h1
          style="margin-top: 0px;"
        >
          Create New Location
        </h1>
        <p>
          <a
            href="/locations"
          >
            ← Back to Locations
          </a>
        </p>
        <form
          style="max-width: 640px; background: rgb(255, 255, 255); border: 1px solid rgb(229, 231, 235); border-radius: 8px; padding: 16px;"
        >
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="name"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Name
            </label>
            <input
              aria-invalid="false"
              id="name"
              name="name"
              placeholder="e.g., Living room shelf"
              required=""
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; border-color: rgb(209, 213, 219);"
              value=""
            />
          </div>
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="description"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Description
            </label>
            <textarea
              id="description"
              name="description"
              placeholder="Optional notes about this location"
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; min-height: 90px; resize: vertical;"
            />
          </div>
          <div
            style="display: flex; gap: 8px;"
          >
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: rgb(17, 24, 39); color: white;"
              type="submit"
            >
              Save
            </button>
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: transparent; border-color: rgb(209, 213, 219);"
              type="button"
            >
              Cancel
            </button>
          </div>
        </form>
      </main>
    </div>
  </div>
</body>
Ignored nodes: comments, script, style
<body>
  <div>
    <div
      class="layout"
    >
      <aside
        class="sidebar"
      >
        <div
          class="sidebar-title"
        >
          Create New Location
        </div>
        <nav>
          <a
            class="nav-link"
            href="/dashboard"
          >
            Overview
          </a>
          <a
            class="nav-link"
            href="/daily"
          >
            Daily Care
          </a>
          <a
            class="nav-link"
            href="/plants"
          >
            Plants
          </a>
          <a
            class="nav-link"
            href="/locations"
          >
            Locations
          </a>
          <a
            class="nav-link"
            href="/settings"
          >
            Settings
          </a>
        </nav>
        <div
          class="mt-4"
        >
          <a
            class="back-link"
            href="/"
          >
            ← Back to Home
          </a>
        </div>
      </aside>
      <main
        class="main"
      >
        <h1
          style="margin-top: 0px;"
        >
          Create New Location
        </h1>
        <p>
          <a
            href="/locations"
          >
            ← Back to Locations
          </a>
        </p>
        <form
          style="max-width: 640px; background: rgb(255, 255, 255); border: 1px solid rgb(229, 231, 235); border-radius: 8px; padding: 16px;"
        >
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="name"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Name
            </label>
            <input
              aria-invalid="false"
              id="name"
              name="name"
              placeholder="e.g., Living room shelf"
              required=""
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; border-color: rgb(209, 213, 219);"
              value=""
            />
          </div>
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="description"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Description
            </label>
            <textarea
              id="description"
              name="description"
              placeholder="Optional notes about this location"
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; min-height: 90px; resize: vertical;"
            />
          </div>
          <div
            style="display: flex; gap: 8px;"
          >
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: rgb(17, 24, 39); color: white;"
              type="submit"
            >
              Save
            </button>
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: transparent; border-color: rgb(209, 213, 219);"
              type="button"
            >
              Cancel
            </button>
          </div>
        </form>
      </main>
    </div>
  </div>
</body>
   ✓ pages/LocationCreate > successful save posts to API and navigates back to /locations  1132ms
   ✓ pages/LocationCreate > server error maps to name field error  452ms
   ✓ pages/LocationCreate > cancel button navigates back to /locations without saving 212ms
   ✓ pages/LocationCreate > renders under dark theme (style branches executed)  784ms
 ✓ tests/unit/components/StatusIcon.test.jsx (4 tests) 1694ms
   ✓ StatusIcon > computes title/aria-label based on type and active; defaults when no label provided  896ms
   ✓ StatusIcon > applies light theme styles for active/inactive and border color  346ms
   ✓ StatusIcon > applies dark theme styles for active/inactive, including border and inset shadow  344ms
 ✓ tests/unit/components/form/fields/DateTimeLocal.test.jsx (3 tests) 2517ms
   ✓ DateTimeLocal field > renders label, allows typing datetime string, respects required/disabled  1199ms
   ✓ DateTimeLocal field > shows validation error on blur and wires aria attributes  942ms
   ✓ DateTimeLocal field > applies dark theme styles and error border styles  341ms
 ✓ tests/unit/pages/BulkWeightMeasurement.test.jsx (3 tests) 3885ms
   ✓ pages/BulkWeightMeasurement > default shows all plants; toggling off shows only needs-water snapshot  1329ms
   ✓ pages/BulkWeightMeasurement > committing weight creates then updates measurement; invalid negative marks error  2301ms
 ✓ tests/unit/components/QuickCreateButtons.test.jsx (2 tests) 1946ms
   ✓ QuickCreateButtons > renders three action buttons and navigates with plant uuid and preserves from state  1326ms
   ✓ QuickCreateButtons > omits plant query when plantUuid is not provided; uses fallback labels and compact gap  596ms
 ✓ tests/unit/components/ConfirmDialog.test.jsx (12 tests) 3602ms
   ✓ ConfirmDialog > renders dialog with a11y labels and focuses the first (Cancel) button  937ms
   ✓ ConfirmDialog > clicking buttons calls respective handlers  439ms
   ✓ ConfirmDialog > icon and tone variations render without error (covers branches)  581ms
   ✓ ConfirmDialog > supports custom buttons when provided  305ms
 ✓ tests/unit/pages/DailyCare.test.jsx (3 tests) 2536ms
   ✓ shows tasks table with measure/water indicators  1847ms
   ✓ renders empty state when no tasks are due  419ms
 ✓ tests/unit/pages/BulkWatering.test.jsx (3 tests) 4593ms
   ✓ pages/BulkWatering > initially shows only plants that needed watering; toggle shows all and deemphasizes above-threshold  1947ms
   ✓ pages/BulkWatering > committing watering creates measurement then updates on second commit; invalid input marks error  2326ms
 ✓ tests/unit/pages/LocationsList.test.jsx (6 tests) 7012ms
   ✓ pages/LocationsList > renders locations after loading  1195ms
   ✓ pages/LocationsList > drag-and-drop reorders and persists order; server error shows saveError  1325ms
   ✓ pages/LocationsList > delete flow: missing uuid shows saveError; API error keeps row; success removes row  3532ms
   ✓ pages/LocationsList > view shows alert with location details  676ms
 ✓ tests/unit/components/form/fields/Select.test.jsx (3 tests) 1923ms
   ✓ Select field > renders label, options, allows selection; respects disabled/required  1022ms
   ✓ Select field > validation error displays on blur with aria attributes; clears after valid selection  606ms
 ✓ tests/unit/components/form/fields/NumberInput.test.jsx (3 tests) 2528ms
   ✓ NumberInput field > renders label, placeholder, numeric typing and respects min/max/step and required/disabled  1133ms
   ✓ NumberInput field > validators: required, then min and max errors with aria wiring  1176ms
 ✓ tests/unit/pages/Settings.test.jsx (2 tests) 2871ms
   ✓ pages/Settings > initializes fields from localStorage and saves updates with success message  2186ms
   ✓ pages/Settings > changing theme select persists theme via ThemeProvider  616ms
 ✓ tests/unit/components/form/fields/TextInput.test.jsx (3 tests) 2396ms
   ✓ TextInput field > renders label, placeholder, supports typing and required/disabled props  1654ms
   ✓ TextInput field > shows validation error on blur and wires aria attributes  488ms
 ✓ tests/unit/pages/PlantsList.test.jsx (10 tests) 23715ms
   ✓ renders plants after loading  1581ms
   ✓ renders empty state when no plants  425ms
   ✓ numeric search filters by threshold (<= query)  1478ms
   ✓ applies updatedPlant from router state without crashing (effect path exercised)  597ms
   ✓ drag-and-drop reorders rows and persists order; server error shows saveError  1641ms
   ✓ moveUp/moveDown buttons reorder and persist; disabled at edges  2246ms
   ✓ delete flow: missing uuid shows saveError; API error shows error; success removes row  4839ms
   ✓ limits list to PAGE_LIMIT and shows meta count  9212ms
   ✓ row branches: link vs plain text, needsWater badge, and view/edit guards without uuid  1516ms
 ✓ tests/unit/components/form/fields/Checkbox.test.jsx (2 tests) 1171ms
   ✓ Checkbox field > renders label, toggles value, and respects disabled/required props  865ms
 ✓ tests/unit/main.test.jsx (1 test) 728ms
   ✓ src/main.jsx bootstrap > mounts React app into #root and renders strict tree with router and routes  707ms
 ✓ tests/unit/hooks/useDocumentTitle.test.jsx (3 tests) 950ms
   ✓ hooks/useDocumentTitle > re-applies same title on route change to counter late writers; reacts to location key changes  730ms
 ✓ tests/unit/components/IconButton.test.jsx (5 tests) 988ms
   ✓ IconButton > renders requested icon, sets a11y labels, calls onClick when enabled  500ms
 ✓ tests/unit/components/feedback/ErrorNotice.test.jsx (3 tests) 634ms
   ✓ components/feedback/ErrorNotice > renders alert with message and optional retry button triggers handler  452ms
 ✓ tests/unit/components/DashboardLayout.test.jsx (4 tests) 719ms
   ✓ DashboardLayout > highlights only the active nav link for current route (covers both branches)  360ms
 ✓ tests/unit/components/Badge.test.jsx (5 tests) 854ms
   ✓ Badge.jsx > renders children, role, and aria-live with default (neutral) tone  551ms
 ✓ tests/unit/App.test.jsx (2 tests) 849ms
   ✓ App.jsx > shows loading, then renders backend message on success  738ms
 ✓ tests/unit/components/feedback/EmptyState.test.jsx (3 tests) 848ms
   ✓ components/feedback/EmptyState > renders with title only and role note  530ms
 ✓ tests/unit/ThemeContext.test.jsx (8 tests) 510ms
 ✓ tests/unit/components/SearchField.test.jsx (3 tests) 1359ms
   ✓ SearchField > renders with defaults and associates a11y attributes  744ms
   ✓ SearchField > typing calls onChange with the typed value  363ms
 ✓ tests/unit/components/DateTimeText.test.jsx (9 tests) 685ms
   ✓ DateTimeText > renders formatted date for valid Date value and respects dtFormat preference (europe default)  448ms
 ✓ tests/unit/components/feedback/Loader.test.jsx (2 tests) 561ms
   ✓ components/feedback/Loader > renders with default accessible semantics and label  446ms
 ✓ tests/unit/pages/Dashboard.test.jsx (1 test) 669ms
   ✓ pages/Dashboard > renders dashboard layout and welcome text  633ms
 ✓ tests/unit/components/form/useForm.test.js (7 tests) 149ms
 ✓ tests/unit/api/client.test.ts (24 tests) 100ms
 ✓ tests/unit/api/locations.test.ts (7 tests) 60ms
 ✓ tests/unit/api/plants.test.ts (9 tests) 115ms
 ✓ tests/unit/utils/datetime.test.js (4 tests) 93ms
 ✓ tests/unit/api/measurements.test.ts (11 tests) 56ms
 ✓ tests/unit/setupTests.spec.ts (4 tests) 24ms
 ✓ tests/unit/api/daily.test.ts (1 test) 39ms
 ✓ tests/unit/utils/water_retained_colors.test.js (3 tests) 38ms
 ✓ tests/unit/utils/waterLoss.test.js (1 test) 18ms
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
 FAIL  tests/unit/pages/LocationCreate.test.jsx > pages/LocationCreate > client-side validation: empty name shows error and a11y wiring; clears on change
TestingLibraryElementError: Unable to find an element with the text: /name is required/i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.
Ignored nodes: comments, script, style
<body>
  <div>
    <div
      class="layout"
    >
      <aside
        class="sidebar"
      >
        <div
          class="sidebar-title"
        >
          Create New Location
        </div>
        <nav>
          <a
            class="nav-link"
            href="/dashboard"
          >
            Overview
          </a>
          <a
            class="nav-link"
            href="/daily"
          >
            Daily Care
          </a>
          <a
            class="nav-link"
            href="/plants"
          >
            Plants
          </a>
          <a
            class="nav-link"
            href="/locations"
          >
            Locations
          </a>
          <a
            class="nav-link"
            href="/settings"
          >
            Settings
          </a>
        </nav>
        <div
          class="mt-4"
        >
          <a
            class="back-link"
            href="/"
          >
            ← Back to Home
          </a>
        </div>
      </aside>
      <main
        class="main"
      >
        <h1
          style="margin-top: 0px;"
        >
          Create New Location
        </h1>
        <p>
          <a
            href="/locations"
          >
            ← Back to Locations
          </a>
        </p>
        <form
          style="max-width: 640px; background: rgb(255, 255, 255); border: 1px solid rgb(229, 231, 235); border-radius: 8px; padding: 16px;"
        >
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="name"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Name
            </label>
            <input
              aria-invalid="false"
              id="name"
              name="name"
              placeholder="e.g., Living room shelf"
              required=""
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; border-color: rgb(209, 213, 219);"
              value=""
            />
          </div>
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="description"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Description
            </label>
            <textarea
              id="description"
              name="description"
              placeholder="Optional notes about this location"
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; min-height: 90px; resize: vertical;"
            />
          </div>
          <div
            style="display: flex; gap: 8px;"
          >
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: rgb(17, 24, 39); color: white;"
              type="submit"
            >
              Save
            </button>
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: transparent; border-color: rgb(209, 213, 219);"
              type="button"
            >
              Cancel
            </button>
          </div>
        </form>
      </main>
    </div>
  </div>
</body>
Ignored nodes: comments, script, style
<body>
  <div>
    <div
      class="layout"
    >
      <aside
        class="sidebar"
      >
        <div
          class="sidebar-title"
        >
          Create New Location
        </div>
        <nav>
          <a
            class="nav-link"
            href="/dashboard"
          >
            Overview
          </a>
          <a
            class="nav-link"
            href="/daily"
          >
            Daily Care
          </a>
          <a
            class="nav-link"
            href="/plants"
          >
            Plants
          </a>
          <a
            class="nav-link"
            href="/locations"
          >
            Locations
          </a>
          <a
            class="nav-link"
            href="/settings"
          >
            Settings
          </a>
        </nav>
        <div
          class="mt-4"
        >
          <a
            class="back-link"
            href="/"
          >
            ← Back to Home
          </a>
        </div>
      </aside>
      <main
        class="main"
      >
        <h1
          style="margin-top: 0px;"
        >
          Create New Location
        </h1>
        <p>
          <a
            href="/locations"
          >
            ← Back to Locations
          </a>
        </p>
        <form
          style="max-width: 640px; background: rgb(255, 255, 255); border: 1px solid rgb(229, 231, 235); border-radius: 8px; padding: 16px;"
        >
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="name"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Name
            </label>
            <input
              aria-invalid="false"
              id="name"
              name="name"
              placeholder="e.g., Living room shelf"
              required=""
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; border-color: rgb(209, 213, 219);"
              value=""
            />
          </div>
          <div
            style="margin-bottom: 14px;"
          >
            <label
              for="description"
              style="display: block; font-weight: 600; margin-bottom: 6px;"
            >
              Description
            </label>
            <textarea
              id="description"
              name="description"
              placeholder="Optional notes about this location"
              style="width: 100%; padding: 8px 10px; border-radius: 6px; border: 1px solid rgb(209, 213, 219); background: white; color: rgb(17, 24, 39); box-sizing: border-box; min-height: 90px; resize: vertical;"
            />
          </div>
          <div
            style="display: flex; gap: 8px;"
          >
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: rgb(17, 24, 39); color: white;"
              type="submit"
            >
              Save
            </button>
            <button
              style="padding: 8px 12px; border-radius: 6px; border: 1px solid transparent; cursor: pointer; background: transparent; border-color: rgb(209, 213, 219);"
              type="button"
            >
              Cancel
            </button>
          </div>
        </form>
      </main>
    </div>
  </div>
</body>
 ❯ waitForWrapper node_modules/@testing-library/dom/dist/wait-for.js:163:27
 ❯ findByText node_modules/@testing-library/dom/dist/query-helpers.js:86:33
 ❯ tests/unit/pages/LocationCreate.test.jsx:49:30
     47|     await user.click(screen.getByRole('button', { name: /save/i }))
     48|
     49|     const err = await screen.findByText(/name is required/i)
       |                              ^
     50|     expect(err).toBeInTheDocument()
     51|     expect(nameInput).toHaveAttribute('aria-invalid', 'true')
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯
 Test Files  1 failed | 38 passed (39)
      Tests  1 failed | 198 passed (199)
   Start at  13:52:26
   Duration  99.44s (transform 4.33s, setup 148.79s, collect 124.49s, tests 81.51s, environment 740.16s, prepare 106.75s)
